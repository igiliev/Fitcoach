!function(){var e={53316:function(e){function t(e,t,r,o){var s,n=null==(s=o)||"number"==typeof s||"boolean"==typeof s?o:r(o),a=t.get(n);return void 0===a&&(a=e.call(this,o),t.set(n,a)),a}function r(e,t,r){var o=Array.prototype.slice.call(arguments,3),s=r(o),n=t.get(s);return void 0===n&&(n=e.apply(this,o),t.set(s,n)),n}function o(e,t,r,o,s){return r.bind(t,e,o,s)}function s(e,s){return o(e,this,1===e.length?t:r,s.cache.create(),s.serializer)}function n(){return JSON.stringify(arguments)}function a(){this.cache=Object.create(null)}a.prototype.has=function(e){return e in this.cache},a.prototype.get=function(e){return this.cache[e]},a.prototype.set=function(e,t){this.cache[e]=t};var i={create:function(){return new a}};e.exports=function(e,t){var r=t&&t.cache?t.cache:i,o=t&&t.serializer?t.serializer:n;return(t&&t.strategy?t.strategy:s)(e,{cache:r,serializer:o})},e.exports.strategies={variadic:function(e,t){return o(e,this,r,t.cache.create(),t.serializer)},monadic:function(e,r){return o(e,this,t,r.cache.create(),r.serializer)}}},33042:function(e,t,r){var o;!function(){"use strict";var s=function e(t){var r,o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),s={use_static:!1};function n(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function a(e,t,r){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:r})}function i(e,t){a(e,t,(function(){throw new b("The "+t+" method cannot be invoked on an Immutable data structure.")}))}"object"!=typeof(r=t)||Array.isArray(r)||null===r||void 0!==t.use_static&&(s.use_static=Boolean(t.use_static));var l="__immutable_invariants_hold";function u(e){return"object"!=typeof e||(null===e||Boolean(Object.getOwnPropertyDescriptor(e,l)))}function p(e,t){return e===t||e!=e&&t!=t}function d(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var c=["setPrototypeOf"],g=c.concat(["push","pop","sort","splice","shift","unshift","reverse"]),m=["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]),f=c.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);function b(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function E(e,t){for(var r in a(e,l,!0),t)t.hasOwnProperty(r)&&i(e,t[r]);return Object.freeze(e),e}function I(e,t){var r=e[t];a(e,t,(function(){return Y(r.apply(e,arguments))}))}function _(e,t,r){var o=r&&r.deep;if(e in this&&(o&&this[e]!==t&&d(t)&&d(this[e])&&(t=Y.merge(this[e],t,{deep:!0,mode:"replace"})),p(this[e],t)))return this;var s=v.call(this);return s[e]=Y(t),P(s)}b.prototype=new Error,b.prototype.constructor=Error;var O=Y([]);function y(e,t,r){var o=e[0];if(1===e.length)return _.call(this,o,t,r);var s,n=e.slice(1),a=this[o];if("object"==typeof a&&null!==a)s=Y.setIn(a,n,t);else{var i=n[0];s=""!==i&&isFinite(i)?y.call(O,n,t):w.call(U,n,t)}if(o in this&&a===s)return this;var l=v.call(this);return l[o]=s,P(l)}function P(e){for(var t in m){if(m.hasOwnProperty(t))I(e,m[t])}s.use_static||(a(e,"flatMap",S),a(e,"asObject",N),a(e,"asMutable",v),a(e,"set",_),a(e,"setIn",y),a(e,"update",B),a(e,"updateIn",k),a(e,"getIn",F));for(var r=0,o=e.length;r<o;r++)e[r]=Y(e[r]);return E(e,g)}function T(){return new Date(this.getTime())}function S(e){if(0===arguments.length)return this;var t,r=[],o=this.length;for(t=0;t<o;t++){var s=e(this[t],t,this);Array.isArray(s)?r.push.apply(r,s):r.push(s)}return P(r)}function A(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach((function(e,t,r){"number"==typeof e&&(r[t]=e.toString())})),e=function(e,r){return-1!==t.indexOf(r)}}var r=n(this);for(var o in this)this.hasOwnProperty(o)&&!1===e(this[o],o)&&(r[o]=this[o]);return $(r)}function v(e){var t,r,o=[];if(e&&e.deep)for(t=0,r=this.length;t<r;t++)o.push(R(this[t]));else for(t=0,r=this.length;t<r;t++)o.push(this[t]);return o}function N(e){"function"!=typeof e&&(e=function(e){return e});var t,r={},o=this.length;for(t=0;t<o;t++){var s=e(this[t],t,this),n=s[0],a=s[1];r[n]=a}return $(r)}function R(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,l)||e instanceof Date?e:Y.asMutable(e,{deep:!0})}function G(e,t){for(var r in e)Object.getOwnPropertyDescriptor(e,r)&&(t[r]=e[r]);return t}function L(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var r,o,s=Array.isArray(e),a=t&&t.deep,i=t&&t.mode||"merge",l=t&&t.merger;function u(e,o,s){var i,u=Y(o[s]),c=l&&l(e[s],u,t),g=e[s];void 0===r&&void 0===c&&e.hasOwnProperty(s)&&p(u,g)||(p(g,i=void 0!==c?c:a&&d(g)&&d(u)?Y.merge(g,u,t):u)&&e.hasOwnProperty(s)||(void 0===r&&(r=G(e,n(e))),r[s]=i))}function c(e,t){for(var o in e)t.hasOwnProperty(o)||(void 0===r&&(r=G(e,n(e))),delete r[o])}if(s)for(var g=0,m=e.length;g<m;g++){var f=e[g];for(o in f)f.hasOwnProperty(o)&&u(void 0!==r?r:this,f,o)}else{for(o in e)Object.getOwnPropertyDescriptor(e,o)&&u(this,e,o);"replace"===i&&c(this,e)}return void 0===r?this:$(r)}function h(e,t){var r=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return Y.merge(this,e,{deep:r,mode:"replace"})}var D,C,M,U=Y({});function w(e,t,r){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var o=e[0];if(1===e.length)return V.call(this,o,t,r);var s,a=e.slice(1),i=this[o];if(s=this.hasOwnProperty(o)&&"object"==typeof i&&null!==i?Y.setIn(i,a,t):w.call(U,a,t),this.hasOwnProperty(o)&&i===s)return this;var l=G(this,n(this));return l[o]=s,$(l)}function V(e,t,r){var o=r&&r.deep;if(this.hasOwnProperty(e)&&(o&&this[e]!==t&&d(t)&&d(this[e])&&(t=Y.merge(this[e],t,{deep:!0,mode:"replace"})),p(this[e],t)))return this;var s=G(this,n(this));return s[e]=Y(t),$(s)}function B(e,t){var r=Array.prototype.slice.call(arguments,2),o=this[e];return Y.set(this,e,t.apply(o,[o].concat(r)))}function j(e,t){for(var r=0,o=t.length;null!=e&&r<o;r++)e=e[t[r]];return r&&r==o?e:void 0}function k(e,t){var r=Array.prototype.slice.call(arguments,2),o=j(this,e);return Y.setIn(this,e,t.apply(o,[o].concat(r)))}function F(e,t){var r=j(this,e);return void 0===r?t:r}function W(e){var t,r=n(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(r[t]=R(this[t]));else for(t in this)this.hasOwnProperty(t)&&(r[t]=this[t]);return r}function x(){return{}}function $(e){return s.use_static||(a(e,"merge",L),a(e,"replace",h),a(e,"without",A),a(e,"asMutable",W),a(e,"set",V),a(e,"setIn",w),a(e,"update",B),a(e,"updateIn",k),a(e,"getIn",F)),E(e,c)}function Y(e,t,r){if(u(e)||function(e){return"object"==typeof e&&null!==e&&(60103===e.$$typeof||e.$$typeof===o)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(Y);if(Array.isArray(e))return P(e.slice());if(e instanceof Date)return n=new Date(e.getTime()),s.use_static||a(n,"asMutable",T),E(n,f);var n,i=t&&t.prototype,l=(i&&i!==Object.prototype?function(){return Object.create(i)}:x)();if(null==r&&(r=64),r<=0)throw new b("Attempt to construct Immutable from a deeply nested object was detected. Have you tried to wrap an object with circular references (e.g. React element)? See https://github.com/rtfeldman/seamless-immutable/wiki/Deeply-nested-object-was-detected for details.");for(var p in r-=1,e)Object.getOwnPropertyDescriptor(e,p)&&(l[p]=Y(e[p],void 0,r));return $(l)}function z(e){return function(){var t=[].slice.call(arguments),r=t.shift();return e.apply(r,t)}}function K(e,t){return function(){var r=[].slice.call(arguments),o=r.shift();return Array.isArray(o)?t.apply(o,r):e.apply(o,r)}}return Y.from=Y,Y.isImmutable=u,Y.ImmutableError=b,Y.merge=z(L),Y.replace=z(h),Y.without=z(A),Y.asMutable=(D=W,C=v,M=T,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?C.apply(t,e):t instanceof Date?M.apply(t,e):D.apply(t,e)}),Y.set=K(V,_),Y.setIn=K(w,y),Y.update=z(B),Y.updateIn=z(k),Y.getIn=z(F),Y.flatMap=z(S),Y.asObject=z(N),s.use_static||(Y.static=e({use_static:!0})),Object.freeze(Y),Y}();void 0===(o=function(){return s}.call(t,r,t,e))||(e.exports=o)}()}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";r.r(o),r.d(o,{GlobalDataStyle:function(){return ur},GlobalDataStyleContainer:function(){return pr},addDefaultModulePreset:function(){return B},addDefaultOptionGroupPreset:function(){return Se},addFontColorVariable:function(){return f},addGlobalColor:function(){return D},addGlobalVariable:function(){return Re},addGlobalVariables:function(){return Ge},addNewOptionGroupPreset:function(){return Pe},addNewOptionGroupPresetFromCurrentStyles:function(){return Oe},addNewPreset:function(){return j},addNewPresetFromCurrentStyles:function(){return k},addPresetAttrsMapJob:function(){return re},assignOptionGroupPresetToDefault:function(){return Te},assignPresetToDefault:function(){return F},bootstrapGlobalVariables:function(){return m},cloneOptionGroupPreset:function(){return _e},clonePreset:function(){return W},closeConfirmationModal:function(){return x},closeOptionGroupConfirmationModal:function(){return $},closeOptionGroupPresetEditMode:function(){return ve},closeOptionGroupPresetModal:function(){return Ae},closePresetModal:function(){return Y},deleteGlobalColor:function(){return C},deleteGlobalVariable:function(){return Le},deleteModulePreset:function(){return z},deleteOptionGroupPreset:function(){return ye},editPresetAttribute:function(){return K},effects:function(){return nr},endPresetEditSession:function(){return le},endSyncingPreset:function(){return ce},generateDefaultPresetName:function(){return _},generateNanoUuid:function(){return I},generateNewOptionGroupPreset:function(){return O},generateNewPreset:function(){return y},generateVariableId:function(){return P},getAllGroupPresetData:function(){return Ft},getAllPresetData:function(){return Ct},getAllowedActions:function(){return g},getDefaultPreset:function(){return gt},getDefaultPresetID:function(){return ct},getDefaultPresetOnSave:function(){return ht},getFormattedCSSValue:function(){return T},getGlobalColorBasedOnCssVariable:function(){return St},getGlobalColorById:function(){return tt},getGlobalColorIdFromValue:function(){return S},getGlobalColorLabel:function(){return Ot},getGlobalColorPalette:function(){return ot},getGlobalColorValue:function(){return dt},getGlobalColors:function(){return st},getGlobalColorsByStatus:function(){return at},getGlobalColorsToExport:function(){return ut},getGlobalOrPreviewColorValue:function(){return wt},getGlobalOrPreviewColorValues:function(){return Vt},getGlobalPreviewColors:function(){return nt},getGlobalVariable:function(){return A},getGlobalVariableByGroup:function(){return Kt},getGlobalVariableById:function(){return zt},getGlobalVariableValue:function(){return v},getGlobalVariables:function(){return Ht},getGlobalVariablesToExport:function(){return pt},getGroupPreset:function(){return jt},getGroupPresets:function(){return kt},getGroupsForDefaultPreset:function(){return $t},getModulePreset:function(){return mt},getModulePresets:function(){return bt},getModulePresetsList:function(){return Et},getOptionGroupPresetConfirmationModal:function(){return et},getOptionGroupPresetEditMode:function(){return xt},getOptionGroupPresetModalState:function(){return Bt},getOptionGroupPresetSaveConfirmationDialogFlag:function(){return Yt},getPresetAttr:function(){return It},getPresetAttrsMap:function(){return Lt},getPresetAttrsMapJobs:function(){return Gt},getPresetConfirmationModal:function(){return Xe},getPresetSaveConfirmationDialogFlag:function(){return Mt},getPreviewGlobalColors:function(){return Ut},getRenderableValue:function(){return _t},importGlobalColors:function(){return M},importPresets:function(){return te},isActiveConfirmationModal:function(){return Pt},isActiveGlobalColor:function(){return At},isActiveOptionGroupConfirmationModal:function(){return Tt},isActiveOptionGroupPresetModal:function(){return Rt},isActivePreset:function(){return Nt},isCustomizerFontVariable:function(){return h},isGlobalColor:function(){return N},isGlobalColorEditing:function(){return vt},isGlobalColorRemovable:function(){return yt},isGlobalVariable:function(){return R},isOptionGroupPresetEditing:function(){return Wt},isPresetSyncing:function(){return Dt},normalizeOptionGroupPresetId:function(){return G},normalizePresetId:function(){return L},openConfirmationModal:function(){return H},openOptionGroupConfirmationModal:function(){return J},openOptionGroupPresetModal:function(){return Z},openPresetModal:function(){return q},overridePresetData:function(){return pe},registerGlobalDataStore:function(){return lr},removeGlobalColorPreviewValue:function(){return fe},removePresetAttribute:function(){return Q},resetGlobalVariables:function(){return Ue},restoreGlobalVariable:function(){return we},saveGlobalVariables:function(){return Ve},savePreset:function(){return de},setDefaultPresetOnSave:function(){return se},setGlobalColorPreviewValue:function(){return be},setIsGlobalColorEditing:function(){return ne},setOptionGroupPresetEditMode:function(){return ae},setPresetAttrsMap:function(){return oe},startPresetEditSession:function(){return ue},startSyncingPreset:function(){return ge},toggleOptionGroupPresetSaveConfirmationDialog:function(){return Ne},togglePresetSaveConfirmationDialog:function(){return me},unsetDefaultPresetOnSave:function(){return ie},updateGlobalColor:function(){return U},updateGlobalColors:function(){return w},updateGlobalColorsUsedInPosts:function(){return V},updateGlobalVariable:function(){return he},updateGlobalVariableOrder:function(){return Ce},updateGlobalVariables:function(){return De},updateGlobalVariablesBackup:function(){return Me},updateOptionGroupPresetName:function(){return Ie},updateOptionGroupPresetWithCurrentStyles:function(){return Ee},updatePresetName:function(){return X},updatePresetWithCurrentStyles:function(){return ee}});var e={};r.r(e),r.d(e,{addDefaultModulePreset:function(){return B},addDefaultOptionGroupPreset:function(){return Se},addGlobalColor:function(){return D},addGlobalVariable:function(){return Re},addGlobalVariables:function(){return Ge},addNewOptionGroupPreset:function(){return Pe},addNewOptionGroupPresetFromCurrentStyles:function(){return Oe},addNewPreset:function(){return j},addNewPresetFromCurrentStyles:function(){return k},addPresetAttrsMapJob:function(){return re},assignOptionGroupPresetToDefault:function(){return Te},assignPresetToDefault:function(){return F},cloneOptionGroupPreset:function(){return _e},clonePreset:function(){return W},closeConfirmationModal:function(){return x},closeOptionGroupConfirmationModal:function(){return $},closeOptionGroupPresetEditMode:function(){return ve},closeOptionGroupPresetModal:function(){return Ae},closePresetModal:function(){return Y},deleteGlobalColor:function(){return C},deleteGlobalVariable:function(){return Le},deleteModulePreset:function(){return z},deleteOptionGroupPreset:function(){return ye},editPresetAttribute:function(){return K},endPresetEditSession:function(){return le},endSyncingPreset:function(){return ce},importGlobalColors:function(){return M},importPresets:function(){return te},openConfirmationModal:function(){return H},openOptionGroupConfirmationModal:function(){return J},openOptionGroupPresetModal:function(){return Z},openPresetModal:function(){return q},overridePresetData:function(){return pe},removeGlobalColorPreviewValue:function(){return fe},removePresetAttribute:function(){return Q},resetGlobalVariables:function(){return Ue},restoreGlobalVariable:function(){return we},saveGlobalVariables:function(){return Ve},savePreset:function(){return de},setDefaultPresetOnSave:function(){return se},setGlobalColorPreviewValue:function(){return be},setIsGlobalColorEditing:function(){return ne},setOptionGroupPresetEditMode:function(){return ae},setPresetAttrsMap:function(){return oe},startPresetEditSession:function(){return ue},startSyncingPreset:function(){return ge},toggleOptionGroupPresetSaveConfirmationDialog:function(){return Ne},togglePresetSaveConfirmationDialog:function(){return me},unsetDefaultPresetOnSave:function(){return ie},updateGlobalColor:function(){return U},updateGlobalColors:function(){return w},updateGlobalColorsUsedInPosts:function(){return V},updateGlobalVariable:function(){return he},updateGlobalVariableOrder:function(){return Ce},updateGlobalVariables:function(){return De},updateGlobalVariablesBackup:function(){return Me},updateOptionGroupPresetName:function(){return Ie},updateOptionGroupPresetWithCurrentStyles:function(){return Ee},updatePresetName:function(){return X},updatePresetWithCurrentStyles:function(){return ee}});var t={};r.r(t),r.d(t,{getAllGroupPresetData:function(){return Ft},getAllPresetData:function(){return Ct},getDefaultPreset:function(){return gt},getDefaultPresetID:function(){return ct},getDefaultPresetOnSave:function(){return ht},getGlobalColorBasedOnCssVariable:function(){return St},getGlobalColorById:function(){return tt},getGlobalColorLabel:function(){return Ot},getGlobalColorPalette:function(){return ot},getGlobalColorValue:function(){return dt},getGlobalColors:function(){return st},getGlobalColorsByStatus:function(){return at},getGlobalColorsToExport:function(){return ut},getGlobalOrPreviewColorValue:function(){return wt},getGlobalOrPreviewColorValues:function(){return Vt},getGlobalPreviewColors:function(){return nt},getGlobalVariableByGroup:function(){return Kt},getGlobalVariableById:function(){return zt},getGlobalVariables:function(){return Ht},getGlobalVariablesToExport:function(){return pt},getGroupPreset:function(){return jt},getGroupPresets:function(){return kt},getGroupsForDefaultPreset:function(){return $t},getModulePreset:function(){return mt},getModulePresets:function(){return bt},getModulePresetsList:function(){return Et},getOptionGroupPresetConfirmationModal:function(){return et},getOptionGroupPresetEditMode:function(){return xt},getOptionGroupPresetModalState:function(){return Bt},getOptionGroupPresetSaveConfirmationDialogFlag:function(){return Yt},getPresetAttr:function(){return It},getPresetAttrsMap:function(){return Lt},getPresetAttrsMapJobs:function(){return Gt},getPresetConfirmationModal:function(){return Xe},getPresetSaveConfirmationDialogFlag:function(){return Mt},getPreviewGlobalColors:function(){return Ut},getRenderableValue:function(){return _t},isActiveConfirmationModal:function(){return Pt},isActiveGlobalColor:function(){return At},isActiveOptionGroupConfirmationModal:function(){return Tt},isActiveOptionGroupPresetModal:function(){return Rt},isActivePreset:function(){return Nt},isGlobalColorEditing:function(){return vt},isGlobalColorRemovable:function(){return yt},isOptionGroupPresetEditing:function(){return Wt},isPresetSyncing:function(){return Dt}});var s=window.lodash,n=r(33042),a=r.n(n),i=window.divi.colors,l=window.divi.data,u=window.divi.fonts,p=window.divi.middleware,d=window.divi.moduleUtils,c=window.divi.settings;const g=e=>{const t={editLabel:!0,editValue:!0,remove:!0,reorder:!0};return"customizer"===e&&(t.editLabel=!1,t.remove=!1,t.reorder=!1),t},m=e=>{const t=(0,l.select)("divi/fonts").getCustomizerFonts(),{heading:r,body:o}=t,s=(0,l.select)("divi/global-data").getGlobalColors()??{};if(e.includes("fonts")){const e=[];r?.fontId&&e.push({id:r.fontId,label:r.label,value:r.fontName,groupKey:"fonts",status:"active",order:1,allowedActions:g("customizer")}),o?.fontId&&e.push({id:o.fontId,label:o.label,value:o.fontName,groupKey:"fonts",status:"active",order:2,allowedActions:g("customizer")}),e.length>0&&(0,l.dispatch)("divi/global-data").updateGlobalVariables(e)}if(e.includes("colors")){const e=[];Object.entries(s).forEach((([t,{color:r,label:o,folder:s,status:n,order:a,lastUpdated:i}],l)=>{e.push({id:t,label:o||r,value:r,groupKey:"colors",status:"active"===n?n:"archived",allowedActions:g(s),order:a||l+1,lastUpdated:i})})),(0,l.dispatch)("divi/global-data").updateGlobalVariables(e)}},f=(e,t,r,o,s,n,a,i)=>{(0,l.dispatch)("divi/global-data").addGlobalVariable({id:t,label:r,value:o,allowedActions:s,lastUpdated:i,order:n,groupKey:e,status:"active"===a?a:"archived"})};let b=e=>crypto.getRandomValues(new Uint8Array(e)),E=(e,t=21)=>((e,t,r)=>{let o=(2<<Math.log(e.length-1)/Math.LN2)-1,s=-~(1.6*o*t/e.length);return(n=t)=>{let a="";for(;;){let t=r(s),i=s;for(;i--;)if(a+=e[t[i]&o]||"",a.length===n)return a}}})(e,t,b);const I=()=>E("0123456789abcdefghijklmnopqrstuvwxyz",10)(),_=(e,t)=>{const r=e=>`${t} ${e}`;if(!e.length)return{id:I(),name:r(1)};const o=new RegExp(`^${t} (\\d+)$`,"i"),s=e.filter((e=>o.test(e)));if(!s.length)return{id:I(),name:r(1)};const n=s.sort(((e,t)=>{const r=Number(o.exec(e)[1]);return Number(o.exec(t)[1])-r})),a=o.exec(n[0]),i=Number(a[1])+1;return{id:I(),name:r(i)}},O=({presets:e,groupLabel:t,groupName:r,moduleName:o,attrs:n={},renderAttrs:a={},styleAttrs:i={},version:l,created:u,updated:p,groupId:c,primaryAttrName:g})=>{const{id:m,name:f}=_(e,t),b={type:"group",id:m,name:f,version:l,created:u,updated:p,groupName:r,moduleName:o,groupId:c};(0,s.isEmpty)(n)||(b.attrs=n),(0,s.isEmpty)(a)||(b.renderAttrs=a),(0,s.isEmpty)(i)||(b.styleAttrs=i);const E=(0,d.optionGroupPresetPrimaryAttrNameResolver)({primaryAttrName:g,groupId:c,groupName:r,moduleName:o});return E&&(b.primaryAttrName=E),b},y=({presets:e,moduleLabel:t,moduleName:r,attrs:o={},renderAttrs:n={},styleAttrs:a={},type:i="module",version:l="5.0.0",created:u,updated:p})=>{const{id:d,name:c}=_(e,t),g={id:d,name:c,moduleName:r,version:l,type:i,created:u,updated:p};return(0,s.isEmpty)(o)||(g.attrs=o),(0,s.isEmpty)(n)||(g.renderAttrs=n),(0,s.isEmpty)(a)||(g.styleAttrs=a),g},P=(e,t)=>e||("colors"===t?`gcid-${I()}`:`gvid-${I()}`),T=(e,t)=>e.startsWith("--")?`${e}: ${t} !important;`:`--${e}: ${t};`,S=({value:e})=>{if("string"!=typeof e)return null;const t=/--gcid-([0-9a-z-]*)/.exec(e);return t&&t.length>=2?`gcid-${t[1]}`:null},A=e=>(0,l.select)("divi/global-data").getGlobalVariableById(e),v=e=>A(e)?.value??null,N=e=>Boolean(S({value:e})),R=e=>!!e&&(!(!e.startsWith("gvid")&&!e.startsWith("gcid"))||!!["--et_global_heading_font","--et_global_body_font"].includes(e)),G=({presetId:e,groupName:t,state:r})=>(0,d.getSelectedPresetOrDefault)(e,r.getIn(["presets","items","group",t,"default"])),L=({id:e,moduleName:t,state:r})=>(0,d.getSelectedPresetOrDefault)(e,r.getIn(["presets","items","module",t,"default"])),h=e=>["--et_global_heading_font","--et_global_body_font"].includes(e),D=({color:e,id:t=I(),lastUpdated:r=(new Date).toISOString()})=>{(0,s.isEmpty)(t)?t=`gcid-${I()}`:t.startsWith("gcid-")||(t=`gcid-${t}`);return!(0,s.isEmpty)(r)&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/.test(r)||(r=(new Date).toISOString()),{type:"ADD_GLOBAL_COLOR",color:e,id:t,lastUpdated:r}},C=e=>({type:"DELETE_GLOBAL_COLOR",id:e}),M=(e,t)=>({type:"IMPORT_GLOBAL_COLORS",ids:e,data:t}),U=(e,t)=>({type:"UPDATE_GLOBAL_COLOR",id:e,color:t}),w=e=>({type:"UPDATE_GLOBAL_COLORS",palette:e}),V=(e,t,r)=>(!(0,s.isEmpty)(r)&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/.test(r)||(r=(new Date).toISOString()),{type:"UPDATE_GLOBAL_COLORS_USED_IN_POSTS",postId:e,globalColorIds:t,lastUpdated:r}),B=({moduleName:e,moduleLabel:t,presetType:r,version:o,created:s,updated:n})=>({type:"ADD_DEFAULT_MODULE_PRESET",moduleName:e,moduleLabel:t,presetType:r,version:o,created:s,updated:n}),j=({moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:s,styleAttrs:n,presetType:a,version:i,created:l,updated:u})=>({type:"ADD_NEW_MODULE_PRESET",moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:s,styleAttrs:n,presetType:a,version:i,created:l,updated:u}),k=({moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:s,styleAttrs:n,presetType:a,version:i,created:l,updated:u})=>({type:"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES",moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:s,styleAttrs:n,presetType:a,version:i,created:l,updated:u}),F=(e,t)=>({type:"ASSIGN_PRESET_TO_DEFAULT",presetId:e,moduleName:t}),W=(e,t,r,o)=>({type:"CLONE_MODULE_PRESET",presetId:e,moduleName:t,moduleLabel:r,moduleId:o}),x=()=>({type:"CLOSE_CONFIRMATION_MODAL"}),$=()=>({type:"CLOSE_OPTION_GROUP_CONFIRMATION_MODAL"}),Y=()=>({type:"CLOSE_PRESET_MODAL"}),z=(e,t)=>({type:"DELETE_MODULE_PRESET",presetId:e,moduleName:t}),K=({presetType:e,presetSubType:t,presetId:r,attrName:o,attrValue:s,updated:n,attrsGroup:a})=>({type:"EDIT_PRESET_ATTRIBUTE",presetType:e,presetSubType:t,presetId:r,attrName:o,attrValue:s,updated:n,attrsGroup:a}),H=({confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o})=>({type:"OPEN_CONFIRMATION_MODAL",confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o}),J=({confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o})=>({type:"OPEN_OPTION_GROUP_CONFIRMATION_MODAL",confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o}),q=()=>({type:"OPEN_PRESET_MODAL"}),Z=({groupId:e,visible:t,offsetTop:r,groupName:o,groupLabel:s})=>({type:"OPEN_OPTION_GROUP_PRESET_MODAL",groupId:e,visible:t,offsetTop:r,groupName:o,groupLabel:s}),Q=({presetType:e,presetSubType:t,presetId:r,attrName:o,attrsGroup:s})=>({type:"REMOVE_PRESET_ATTRIBUTE",presetType:e,presetSubType:t,presetId:r,attrName:o,attrsGroup:s}),X=({presetId:e,moduleName:t,name:r,updated:o})=>({type:"UPDATE_PRESET_NAME",presetId:e,moduleName:t,name:r,updated:o}),ee=({presetId:e,moduleName:t,attrs:r,styleAttrs:o,renderAttrs:s,moduleId:n,updated:a})=>({type:"UPDATE_PRESET_WITH_CURRENT_STYLES",presetId:e,moduleName:t,attrs:r,styleAttrs:o,renderAttrs:s,moduleId:n,updated:a}),te=(e,t)=>({type:"IMPORT_PRESETS",presets:e,isConversion:t}),re=({moduleName:e,id:t,callback:r})=>({type:"ADD_PRESET_ATTRS_MAP_JOB",moduleName:e,id:t,callback:r}),oe=({moduleName:e,map:t})=>({type:"SET_PRESET_ATTRS_MAP",moduleName:e,map:t}),se=({presetType:e,presetSubType:t,presetId:r})=>({type:"SET_DEFAULT_PRESET_ON_SAVE",presetType:e,presetSubType:t,presetId:r}),ne=e=>({type:"SET_IS_GLOBAL_COLOR_EDITING",isEditing:e.isEditing}),ae=({groupId:e,groupName:t,enabled:r})=>({type:"SET_OPTION_GROUP_PRESET_EDIT_MODE",groupId:e,groupName:t,enabled:r}),ie=(e={})=>({type:"UNSET_DEFAULT_PRESET_ON_SAVE",presetType:e.presetType,presetSubType:e.presetSubType}),le=(e,t,r)=>({type:"END_PRESET_EDIT_SESSION",isRollback:e,presetType:t,unsavedPresetGroupName:r}),ue=({presetType:e,presetId:t,moduleName:r})=>({type:"START_PRESET_EDIT_SESSION",presetType:e,presetId:t,moduleName:r}),pe=e=>({type:"OVERRIDE_PRESET_DATA",data:e}),de=()=>({type:"SAVE_PRESET"}),ce=e=>({type:"END_SYNCING_PRESET",isError:e}),ge=()=>({type:"START_SYNCING_PRESET"}),me=({flag:e})=>({type:"TOGGLE_PRESET_SAVE_CONFIRMATION_DIALOG",flag:e}),fe=e=>({type:"REMOVE_GLOBAL_COLOR_PREVIEW_VALUE",colorId:e}),be=(e,t)=>({type:"SET_GLOBAL_COLOR_PREVIEW_VALUE",colorId:e,color:t}),Ee=({moduleId:e,presetId:t,groupId:r,groupName:o,attrs:s,renderAttrs:n,styleAttrs:a,updated:i})=>({type:"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES",moduleId:e,presetId:t,groupId:r,groupName:o,attrs:s,renderAttrs:n,styleAttrs:a,updated:i}),Ie=({presetId:e,groupName:t,name:r,updated:o})=>({type:"UPDATE_OPTION_GROUP_PRESET_NAME",presetId:e,groupName:t,name:r,updated:o}),_e=({presetId:e,groupId:t,groupName:r,groupLabel:o,moduleId:s})=>({type:"CLONE_OPTION_GROUP_PRESET",presetId:e,groupId:t,groupName:r,groupLabel:o,moduleId:s}),Oe=({moduleId:e,groupId:t,groupName:r,groupLabel:o,attrs:s,renderAttrs:n,styleAttrs:a,version:i,created:l,updated:u,moduleName:p,primaryAttrName:d})=>({type:"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES",moduleId:e,groupId:t,groupName:r,groupLabel:o,attrs:s,renderAttrs:n,styleAttrs:a,version:i,created:l,updated:u,moduleName:p,primaryAttrName:d}),ye=({presetId:e,groupName:t})=>({type:"DELETE_OPTION_GROUP_PRESET",presetId:e,groupName:t}),Pe=({groupName:e,groupLabel:t,attrs:r,renderAttrs:o,styleAttrs:s,version:n,created:a,updated:i,groupId:l,moduleId:u,moduleName:p,primaryAttrName:d})=>({type:"ADD_NEW_OPTION_GROUP_PRESET",groupName:e,groupLabel:t,attrs:r,renderAttrs:o,styleAttrs:s,version:n,created:a,updated:i,groupId:l,moduleId:u,moduleName:p,primaryAttrName:d}),Te=({presetId:e,groupName:t,groupId:r})=>({type:"ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT",presetId:e,groupName:t,groupId:r}),Se=({groupName:e,groupLabel:t,presetType:r,version:o,created:s,updated:n,moduleName:a,groupId:i,primaryAttrName:l})=>({type:"ADD_DEFAULT_OPTION_GROUP_PRESET",groupName:e,groupLabel:t,presetType:r,version:o,created:s,updated:n,moduleName:a,groupId:i,primaryAttrName:l}),Ae=()=>({type:"CLOSE_OPTION_GROUP_PRESET_MODAL"}),ve=e=>({type:"CLOSE_OPTION_GROUP_PRESET_EDIT_MODE",groupId:e?.groupId,groupName:e?.groupName}),Ne=({flag:e})=>({type:"TOGGLE_OPTION_GROUP_PRESET_SAVE_CONFIRMATION_DIALOG",flag:e}),Re=({id:e,label:t,value:r,groupKey:o,order:s,status:n,allowedActions:a,lastUpdated:i})=>({type:"ADD_GLOBAL_VARIABLE",id:P(e,o),label:t,value:r,groupKey:o,status:n,order:s,allowedActions:a,lastUpdated:i}),Ge=({...e})=>({type:"ADD_GLOBAL_VARIABLES",...e}),Le=({id:e,groupKey:t})=>({type:"DELETE_GLOBAL_VARIABLE",id:e,groupKey:t}),he=({id:e,label:t,value:r,groupKey:o,status:s})=>({type:"UPDATE_GLOBAL_VARIABLE",id:e,label:t,value:r,groupKey:o,status:s}),De=e=>({type:"UPDATE_GLOBAL_VARIABLES",variables:e}),Ce=({id:e,order:t,groupKey:r})=>({type:"UPDATE_GLOBAL_VARIABLE_ORDER",id:e,order:t,groupKey:r}),Me=()=>({type:"UPDATE_GLOBAL_VARIABLES_BACKUP"}),Ue=()=>({type:"RESET_GLOBAL_VARIABLES"}),we=({id:e,groupKey:t})=>({type:"RESTORE_GLOBAL_VARIABLE",id:e,groupKey:t}),Ve=()=>({type:"SAVE_GLOBAL_VARIABLES"}),Be=e=>{switch(e.type){case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":case"UPDATE_PRESET_WITH_CURRENT_STYLES":case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":case"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES":{const{attrs:t,moduleId:r}=e,o=(0,d.flattenAttrs)(t),s=Object.keys(o);(0,l.dispatch)("divi/edit-post").removeModuleAttributes({id:r,attrNames:s});break}}},je=(e,t)=>{switch(e.type){case"ADD_NEW_OPTION_GROUP_PRESET":case"CLONE_OPTION_GROUP_PRESET":case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":{const{groupName:r,groupId:o,moduleId:s}=e,n=t.getState().getIn(["presets"])?.asMutable({deep:!0}),{items:a}=n,i=a?.group?.[r]?.items,u=Object.keys(i).map((e=>i[e].created)),p=Math.max(...u),d=Object.keys(i).find((e=>i[e].created===p));(0,l.dispatch)("divi/edit-post").editGroupPresetAttr({id:s,attrName:o,value:{presetId:d,groupName:r}});break}}},ke=(e,t)=>{switch(e.type){case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":case"ADD_NEW_MODULE_PRESET":case"CLONE_MODULE_PRESET":{const{moduleId:r,moduleName:o}=e,s=t.getState().getIn(["presets"])?.asMutable({deep:!0}),{items:n}=s,a=n?.module?.[o]?.items,i=Object.keys(a).map((e=>a[e].created)),u=Math.max(...i),p=Object.keys(a).find((e=>a[e].created===u));p&&(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:"module",moduleName:o,presetId:p}),(0,l.dispatch)("divi/edit-post").editModuleAttribute({id:r,attrName:"modulePreset",value:p});break}}},Fe=e=>{switch(e.type){case"CLOSE_PRESET_MODAL":(0,l.dispatch)("divi/global-data").endPresetEditSession(!0,"module");break;case"CLOSE_OPTION_GROUP_PRESET_EDIT_MODE":(0,l.dispatch)("divi/global-data").endPresetEditSession(!0,"group")}},We=(e,t)=>{const r=t.getState().getIn(["presets"]).asMutable({deep:!0}),{optionGroupPreset:o}=r,{groupId:s,groupName:n}=o||{},a=r?.isActive;switch(e.type){case"OPEN_PRESET_MODAL":a&&o?.isPresetActive&&(0,l.dispatch)("divi/global-data").closeOptionGroupPresetEditMode({groupId:s,groupName:n}),(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:"module"});break;case"SET_OPTION_GROUP_PRESET_EDIT_MODE":e?.lastActiveGroupId&&s!==e?.lastActiveGroupId&&n!==e?.lastActiveGroupName&&(0,l.dispatch)("divi/global-data").endPresetEditSession(!0,"group",e?.lastActiveGroupName),(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:"group"})}};var xe=window.divi.rest;function $e(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var Ye=e=>Array.isArray(e)?e:[e];function ze(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const r=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Ke(e,t){const r=[],{length:o}=e;for(let s=0;s<o;s++)r.push(e[s].apply(null,t));return r}Symbol(),Object.getPrototypeOf({});var He="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Je(e,t={}){let r={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:o}=t;let s,n=0;function a(){let t=r;const{length:a}=arguments;for(let e=0,r=a;e<r;e++){const r=arguments[e];if("function"==typeof r||"object"==typeof r&&null!==r){let e=t.o;null===e&&(t.o=e=new WeakMap);const o=e.get(r);void 0===o?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=o}else{let e=t.p;null===e&&(t.p=e=new Map);const o=e.get(r);void 0===o?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=o}}const i=t;let l;if(1===t.s?l=t.v:(l=e.apply(null,arguments),n++),i.s=1,o){const e=s?.deref?.()??s;null!=e&&o(e,l)&&(l=e,0!==n&&n--);s="object"==typeof l&&null!==l||"function"==typeof l?new He(l):l}return i.v=l,l}return a.clearCache=()=>{r={s:0,v:void 0,o:null,p:null},a.resetResultsCount()},a.resultsCount=()=>n,a.resetResultsCount=()=>{n=0},a}function qe(e,...t){const r="function"==typeof e?{memoize:e,memoizeOptions:t}:e,o=(...e)=>{let t,o=0,s=0,n={},a=e.pop();"object"==typeof a&&(n=a,a=e.pop()),$e(a,`createSelector expects an output function after the inputs, but received: [${typeof a}]`);const i={...r,...n},{memoize:l,memoizeOptions:u=[],argsMemoize:p=Je,argsMemoizeOptions:d=[],devModeChecks:c={}}=i,g=Ye(u),m=Ye(d),f=ze(e),b=l((function(){return o++,a.apply(null,arguments)}),...g);const E=p((function(){s++;const e=Ke(f,arguments);return t=b.apply(null,e),t}),...m);return Object.assign(E,{resultFunc:a,memoizedResultFunc:b,dependencies:f,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>t,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:l,argsMemoize:p})};return Object.assign(o,{withTypes:()=>o}),o}var Ze=qe(Je),Qe=Object.assign(((e,t=Ze)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const r=Object.keys(e);return t(r.map((t=>e[t])),((...e)=>e.reduce(((e,t,o)=>(e[r[o]]=t,e)),{})))}),{withTypes:()=>Qe});const Xe=Ze([e=>e.getIn(["presets"])],(e=>e.getIn(["confirmationModal"]))),et=Ze([e=>e.getIn(["presets"])],(e=>e.getIn(["optionGroupConfirmationModal"]))),tt=(e,t)=>e.getIn(["globalColors",t]);var rt=window.vendor.wp.i18n;const ot=Ze([e=>e],(e=>{const t=e.getIn(["globalColors"],{}),r=["gcid-primary-color","gcid-secondary-color","gcid-heading-color","gcid-body-color"],o=[],s=[];Object.keys(t).forEach((e=>{const n=t[e];if("active"===n?.status)if(r.includes(e))o.push(n?.id||e);else{const t=Number(n?.order),r=Number.isFinite(t)?t:999;s.push({id:n?.id||e,order:r})}})),s.sort(((e,t)=>e.order-t.order));const n=[...o,...s.map((e=>e.id))];return{id:"global",title:(0,rt.__)("Global","et_builder"),colors:n,configurable:!0,expandable:!1,priority:2,requiresColorUpdateConfirmation:!0,saveChangedColorOnSubmit:!0,addColor:{store:"divi/global-data",actionType:"dispatch",actionName:"addGlobalColor",params:["color"]},deleteColor:{store:"divi/global-data",actionType:"dispatch",actionName:"deleteGlobalColor",params:["colorId"]},updateColor:{store:"divi/global-data",actionType:"dispatch",actionName:"updateGlobalColor",params:["colorId","color"]},getColorValue:{store:"divi/global-data",actionType:"select",actionName:"getGlobalColorValue",params:["colorId","activeOnly"]},getRenderableValue:{store:"divi/global-data",actionType:"select",actionName:"getRenderableValue",params:["colorId","color"]},getGlobalColorLabel:{store:"divi/global-data",actionType:"select",actionName:"getGlobalColorLabel",params:["colorId"]},isGlobalColorRemovable:{store:"divi/global-data",actionType:"select",actionName:"isGlobalColorRemovable",params:["colorId"]},getColorIdFromValue:S,removePreviewColor:{store:"divi/global-data",actionType:"dispatch",actionName:"removeGlobalColorPreviewValue",params:["colorId"]},setPreviewColor:{store:"divi/global-data",actionType:"dispatch",actionName:"setGlobalColorPreviewValue",params:["colorId","color"]}}})),st=e=>e.getIn(["globalColors"],{}),nt=e=>e.getIn(["previewGlobalColors"],{}),at=Ze([e=>e,(e,t)=>t],((e,t)=>{const r=["active","inactive","temporary"].filter((e=>e!==t));return e.getIn(["globalColors"]).without((e=>r.includes(e.status)))}));var it=r(53316),lt=r.n(it);const ut=Ze([e=>e.getIn(["globalColors"]),(e,t)=>t],lt()(((e,t)=>{const r=(0,n.asMutable)(e,{deep:!0}),o=(0,s.pickBy)(r,((e,r)=>(0,s.includes)(t,r)));return Object.entries(o).map((([e,t])=>[e,{color:t.color,status:t.status}]))}))),pt=Ze([e=>e.getIn(["globalVariables"]),(e,t)=>t],lt()(((e,t)=>t.map((t=>{const r=Object.keys(e).find((r=>{const o=e[r];return t in o}));return r?(0,s.omit)({...e[r][t],type:r},["allowedActions"]):null}))))),dt=Ze([e=>e,(e,t)=>t,(e,t,r)=>r],((e,t,r=!1)=>{const o=e.getIn(["globalColors",t]);return!o||r&&"active"!==o.status?"":o.color})),ct=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{presetSubType:t,presetType:r="module"})=>{const o=e?.getIn([r,t,"default"]);return o})),gt=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t,(e,t)=>ct(e,{presetSubType:t.presetSubType,presetType:t.presetType})],((e,{presetSubType:t,presetType:r="module"},o)=>{const s=e?.getIn([r,t,"items",o]);return s})),mt=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t,(e,t)=>gt(e,{presetSubType:t.moduleName})],((e,{moduleName:t,id:r,useDefaultFallback:o,presetType:s="module"},n)=>o?e.getIn([s,t,"items",r])??n:e.getIn([s,t,"items",r]))),ft={},bt=(e,t)=>{const{presets:r}=t;return(0,s.forEach)(ft,((e,t)=>{delete ft[t]})),(0,s.forEach)(r,((t,r)=>{const o=mt(e,t);o&&(ft[r]=o)})),ft},Et=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{moduleName:t,presetType:r="module"})=>{const o=e?.getIn([r,t,"items"]);return o})),It=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{moduleName:t,id:r,attrName:o,presetType:s="module"})=>{const n=e?.getIn([s,t,"items",r,"attrs"]);return n?.getIn(o.split("."))})),_t=(e,t,r)=>"active"===e.getIn(["globalColors",t,"status"],"")?`var(--${t})`:e.getIn(["globalColors",t,"color"],r),Ot=(e,t)=>{const r=e.getIn(["globalColors",t,"color"],"");return e.getIn(["globalColors",t,"label"],r)||r},yt=(e,t)=>"customizer"!==e.getIn(["globalColors",t,"folder"],""),Pt=Ze([e=>e.getIn(["presets","confirmationModal"])],(e=>e.getIn(["isVisible"]))),Tt=Ze([e=>e.getIn(["presets","optionGroupConfirmationModal"])],(e=>e.getIn(["isVisible"]))),St=(e,t)=>{const r=S({value:t});return(0,s.isEmpty)(r)?null:e.getIn(["globalColors",r])},At=(e,t)=>"active"===e.getIn(["globalColors",t,"status"]),vt=e=>e.getIn(["isGlobalColorEditing"],!1),Nt=Ze([e=>e.getIn(["presets"])],(e=>e.getIn(["isActive"]))),Rt=Ze([e=>e.getIn(["presets"])],(e=>e.getIn(["optionGroupPresetModal","isOptionGroupModalOpen"]))),Gt=Ze([e=>e.getIn(["presets","attrsMapping"])],(e=>e?.getIn(["jobs"]))),Lt=Ze([e=>e.getIn(["presets","attrsMapping","maps"]),(e,t)=>t],((e,t)=>e?.getIn([t]))),ht=Ze([e=>e.getIn(["presets","defaultOnSave"]),(e,t)=>t],((e,t)=>{const r=e?.getIn([t.presetType,t.presetSubType]);return r})),Dt=Ze([e=>e.getIn(["presets"])],(e=>e.getIn(["isSyncing"]))),Ct=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,t)=>{const r=t?.presetType??"module";return e?.getIn([r])})),Mt=Ze([e=>e.getIn(["presets"])],(e=>!!e.getIn(["showPresetSaveConfirmationDialog"]))),Ut=e=>e.getIn(["previewGlobalColors"],{}),wt=Ze([e=>e.getIn(["previewGlobalColors"]),e=>e.getIn(["globalColors"]),(e,t)=>t],((e,t,r)=>{if(r.startsWith("var(--")&&(r=S({value:r})),(0,s.isEmpty)(r))return null;const o=e.getIn([r]),n=t.getIn([r]);return o?.color?o.color:n?.color?n.color:null})),Vt=(e,t)=>(t?.globalColorIds??[]).reduce(((t,r)=>({...t,[r]:wt(e,r)})),{}),Bt=Ze([e=>e.getIn(["presets"])],(e=>{const t=e?.getIn(["optionGroupPresetModal"]);return t})),jt=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t,(e,t)=>gt(e,{presetSubType:t.groupName,presetType:"group"})],((e,{groupName:t,id:r,useDefaultFallback:o},s)=>{const n=e.getIn(["group",t,"items",r]);return o?n??s:n})),kt=Ze([e=>e,(e,t)=>t],((e,t)=>{const{presets:r}=t,o={};return(0,s.forEach)(r,((t,r)=>{const s=jt(e,t);s&&(o[r]=s)})),o}),{memoizeOptions:{resultEqualityCheck:s.isEqual}}),Ft=Ze([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{groupName:t})=>e.getIn(["group",t,"items"]))),Wt=Ze([e=>e.getIn(["presets"]),(e,t)=>t,(e,t,r)=>r],((e,t,r)=>{const o=e.getIn(["optionGroupPreset","isPresetActive"]),s=e.getIn(["optionGroupPreset","groupId"]),n=e.getIn(["optionGroupPreset","groupName"]);return o&&s===t&&n===r})),xt=Ze([e=>e.getIn(["presets"])],(e=>{const t=e?.getIn(["optionGroupPreset"]);return t})),$t=e=>{const t=e.getIn(["presets","items","group"]),r=[];return(0,s.forEach)(t,((e,t)=>{const o=e.getIn(["default"]);if(!o)return;const n=e.getIn(["items",o]);(0,s.isEmpty)(n?.attrs)||r.push(t)})),r},Yt=Ze([e=>e.getIn(["presets"])],(e=>!!e.getIn(["optionGroupPreset","showSaveConfirmationDialog"]))),zt=(e,t)=>{const r=e.getIn(["globalVariables"]);if((0,s.isEmpty)(r))return null;const o=Object.keys(r).find((e=>{const o=r[e];return t in o}));return o?r[o][t]:null},Kt=(e,t)=>{const r=e.getIn(["globalVariablesBackup"]);return(0,s.isEmpty)(r)?null:r[t]},Ht=e=>e.getIn(["globalVariables"]),Jt=(e,t)=>{const r=t.getState(),o=st(r);(0,xe.loggedFetch)({method:"POST",restRoute:"/divi/v1/global-data/global-colors",data:{global_colors:o}},!0).catch((e=>{console.log(e)}))},qt=(e,t)=>{const r=Object.keys(e??{}).reduce(((r,o)=>(r[o]=(({data:e,presetType:t,itemModifier:r})=>Object.keys(e??{}).reduce(((o,s)=>{const n=e[s],a=Object.values(n?.items??{}),i={default:n?.default,items:a};return r?o.concat(r(i,t)):o.concat(i)}),[]))({data:e[o],presetType:o,itemModifier:t}),r)),{});return r};var Zt=window.divi.window;var Qt=window.vendor.React,Xt=r.n(Qt);const er=({error:e,onRetry:t,onDownloadBackup:r})=>{const o=()=>{const e=(0,Qt.createElement)("p",null,(0,rt.__)("An error has occurred while saving the Global Presets settings. Various problems can cause a save to fail, such as a lack of server resources, firewall blockages or plugin conflicts or server misconfiguration. You can try saving again by clicking Try Again, or you can download a backup of your unsaved defaults by clicking Download Backup. A backup can be helpful when contacting our Support Team.","et_builder"));(0,l.dispatch)("divi/modal-library").open({name:"divi/alert",centered:!0,dimension:{width:320,height:400},attributes:{title:(0,rt.__)("Save of Global Presets Has Failed","et_builder"),content:e,footerButtons:[{name:"primary",label:(0,rt.__)("Try Again","et_builder"),onClick:e=>{e.preventDefault(),t()}},{name:"secondary",label:(0,rt.__)("Download Backup","et_builder"),onClick:e=>{e.preventDefault(),r()}}],centered:!0}})};e instanceof Response?(async e=>{const t=await e.text();return JSON.parse(t)})(e).then((e=>{console.error(e.message),o()})).catch((()=>{console.error(e),o()})):e instanceof Error?(console.error(e?.message),"AbortError"!==e.name&&o()):(console.error(e),o())},tr=["attrs","styleAttrs","renderAttrs"],rr=({schema:e,presetType:t,defaultOnSave:r})=>(r&&(e=(({schema:e,presetType:t,defaultOnSave:r})=>{const o=r?.[t];if(o){const t=e.items.find((e=>{switch(e.type){case"module":return e.id===o?.[e.moduleName];case"group":return e.id===o?.[e.groupName];default:return!1}}));t&&(e={...e,default:t.id})}else e.default&&e.items.length&&(e={...e,default:e.items[0].id});return e})({schema:e,presetType:t,defaultOnSave:r})),e=(({schema:e})=>{const t=[...e.items];return{...e,items:t.map((e=>{let t={...e};return tr.forEach((r=>{switch(r){case"attrs":case"styleAttrs":case"renderAttrs":if((0,s.has)(e,r)){const o=(0,d.removeEmptyObjectRecursive)(e[r]);(0,s.isEmpty)(o)?delete t[r]:(0,s.isEqual)(o,e[r])||(t={...t,[r]:o})}}})),t}))}})({schema:e}));let or;const sr=(e,t)=>{const r=()=>{t.getState().getIn(["presets","isSyncingError"])&&(0,l.dispatch)("divi/modal-library").close({name:"divi/alert"})},o=()=>{or?.abort&&or.abort()},n=({isConversion:r=!1,endEditMode:n=!0,presetsType:a=""})=>{o(),(0,l.dispatch)("divi/global-data").startSyncingPreset(),or=new AbortController;const i=t.getState().getIn(["presets","items"])?.asMutable({deep:!0}),u=t.getState().getIn(["presets","defaultOnSave"]),p=qt(i,((e,t)=>rr({schema:e,presetType:t,defaultOnSave:u})));(0,xe.fetch)({restRoute:"/divi/v1/global-data/global-preset/sync",method:"POST",data:{presets:p,converted:r},signal:or.signal}).then((e=>{if((0,l.dispatch)("divi/global-data").endSyncingPreset(!1),u&&(0,l.dispatch)("divi/global-data").unsetDefaultPresetOnSave(),(0,s.isEqual)(i,e)||(0,l.dispatch)("divi/global-data").overridePresetData(e),(0,l.dispatch)("divi/global-data").endPresetEditSession(!1,a),(0,l.dispatch)("divi/global-data").closeConfirmationModal(),(0,l.dispatch)("divi/global-data").closeOptionGroupConfirmationModal(),n)(0,l.dispatch)("divi/global-data").closePresetModal(),(0,l.dispatch)("divi/global-data").closeOptionGroupPresetEditMode();else switch(a){case"module":case"group":(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:a});break;default:(0,l.dispatch)("divi/global-data").startPresetEditSession()}})).catch((r=>{(0,l.dispatch)("divi/global-data").endSyncingPreset(!0),er({error:r,onRetry:()=>{sr(e,t)},onDownloadBackup:()=>{(e=>{const t=JSON.stringify(e),r=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(r),s=Zt.topWindow.document.createElement("a");s.style.display="none",s.download="global-defaults-backup.json",s.href=o,Zt.topWindow.document.body.appendChild(s),s.click(),setTimeout((()=>{URL.revokeObjectURL(o),s.parentNode.removeChild(s)}),500)})(i)}})}))};switch(e.type){case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":case"ADD_NEW_MODULE_PRESET":case"CLONE_MODULE_PRESET":r(),(0,l.dispatch)("divi/global-data").openPresetModal(),n({endEditMode:!1,presetsType:"module"});break;case"ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT":r(),(0,l.dispatch)("divi/global-data").closeOptionGroupPresetModal(),n({});break;case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":case"ADD_NEW_OPTION_GROUP_PRESET":case"CLONE_OPTION_GROUP_PRESET":r(),(0,l.dispatch)("divi/global-data").setOptionGroupPresetEditMode({groupId:e.groupId,groupName:e.groupName,enabled:!0}),n({endEditMode:!1,presetsType:"group"});break;case"ASSIGN_PRESET_TO_DEFAULT":case"DELETE_MODULE_PRESET":case"DELETE_OPTION_GROUP_PRESET":case"SAVE_PRESET":case"UPDATE_PRESET_WITH_CURRENT_STYLES":case"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES":r(),n({});break;case"IMPORT_PRESETS":r(),n({isConversion:e.isConversion});break;case"CLOSE_PRESET_MODAL":r(),o()}},nr={ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES:[ke,Be,sr],ADD_NEW_MODULE_PRESET:[ke,sr],ASSIGN_PRESET_TO_DEFAULT:[sr],CLONE_MODULE_PRESET:[ke,sr],CLOSE_PRESET_MODAL:[Fe,sr],DELETE_MODULE_PRESET:[sr],OPEN_PRESET_MODAL:[We],UPDATE_PRESET_WITH_CURRENT_STYLES:[Be,sr],ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES:[je,Be,sr],ADD_NEW_OPTION_GROUP_PRESET:[je,sr],ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT:[sr],CLONE_OPTION_GROUP_PRESET:[je,sr],CLOSE_OPTION_GROUP_PRESET_EDIT_MODE:[Fe,sr],DELETE_OPTION_GROUP_PRESET:[sr],SET_OPTION_GROUP_PRESET_EDIT_MODE:[We],UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES:[Be,sr],SAVE_PRESET:[sr],IMPORT_PRESETS:[e=>{switch(e.type){case"IMPORT_PRESETS":{const e=(0,l.select)("divi/edit-post").getContent()?.asMutable({deep:!0}),t=(0,d.populateUsedPresets)(e),r=(0,d.populateUsedGroupPresets)(e);(0,l.dispatch)("divi/edit-post").updateUsedPresets({presetType:"module",presets:t}),(0,l.dispatch)("divi/edit-post").updateUsedPresets({presetType:"group",presets:r});break}}},sr],ADD_GLOBAL_COLOR:[Jt],DELETE_GLOBAL_COLOR:[Jt,()=>{const e=(0,l.select)("divi/global-data").getGlobalColors();(0,l.dispatch)("divi/edit-post").syncModuleGlobalColors(e)}],IMPORT_GLOBAL_COLORS:[Jt],UPDATE_GLOBAL_COLOR:[Jt],UPDATE_GLOBAL_COLORS_USED_IN_POSTS:[Jt],UPDATE_GLOBAL_COLORS:[Jt],SAVE_GLOBAL_VARIABLES:[(e,t)=>{const r=t.getState(),o=Ht(r);(0,xe.loggedFetch)({method:"POST",restRoute:"/divi/v1/global-data/global-variables",data:{global_variables:o}},!0).catch((e=>{console.log(e)}))}]},ar={SET_OPTION_GROUP_PRESET_EDIT_MODE:[()=>e=>t=>{const r=(0,l.select)("divi/global-data").getOptionGroupPresetEditMode(),o=r?.groupId,s=r?.groupName;t.lastActiveGroupId=o,t.lastActiveGroupName=s;return e(t)}]},ir=(e,t)=>{switch(t.type){case"ADD_GLOBAL_COLOR":return((e,t,r,o)=>{if((0,s.isEmpty)(t)||N(t))return e;const n={id:r,color:t,status:"active",lastUpdated:o,usedInPosts:[]};return e.setIn(["globalColors",n.id],{...n})})(e,t.color,t.id,t.lastUpdated);case"DELETE_GLOBAL_COLOR":return((e,t)=>{const r=e.getIn(["globalColors",t]);return r?e.setIn(["globalColors",t],{...r,lastUpdated:(new Date).toISOString(),status:"inactive"}):e})(e,t.id);case"IMPORT_GLOBAL_COLORS":return((e,t,r)=>{const o=e.getIn(["globalColors"]),n={};return(0,s.forEach)(t,(e=>{o[e]||(n[e]=r[e])})),(0,s.isEmpty)(n)?e:e.setIn(["globalColors"],{...o,...n})})(e,t.ids,t.data);case"UPDATE_GLOBAL_COLOR":return((e,t,r)=>{const o=e.getIn(["globalColors",t]);return!o||(0,s.isEmpty)(r)||N(r)?e:e.setIn(["globalColors",t],{...o,lastUpdated:(new Date).toISOString(),color:r})})(e,t.id,t.color);case"UPDATE_GLOBAL_COLORS":return((e,t)=>{const r=e.getIn(["globalColors"]);return(0,s.isEqual)(r,t)?e:e.setIn(["globalColors"],{...t})})(e,t.palette);case"UPDATE_GLOBAL_COLORS_USED_IN_POSTS":return((e,t,r,o)=>{let n=e.getIn(["globalColors"]);return r.forEach((r=>{const s=e.getIn(["globalColors",r,"usedInPosts"])?.asMutable()??[];s?.includes(t)||(n=n.setIn([r,"usedInPosts"],[...s,t]).setIn([r,"lastUpdated"],o))})),(0,s.forEach)(n,((e,a)=>{if((0,s.isObject)(e)){const s=e.getIn(["usedInPosts"])?.asMutable()??[];s.includes(t)&&!r.includes(a)&&(n=n.setIn([a,"usedInPosts"],s.filter((e=>e!==t))).setIn([a,"lastUpdated"],o))}})),e.setIn(["globalColors"],{...n})})(e,t.postId,t.globalColorIds,t.lastUpdated);case"SET_IS_GLOBAL_COLOR_EDITING":return((e,t)=>e.set("isGlobalColorEditing",t.isEditing))(e,t);case"REMOVE_GLOBAL_COLOR_PREVIEW_VALUE":return((e,t)=>e.setIn(["previewGlobalColors"],e.previewGlobalColors.without(t)))(e,t.colorId);case"SET_GLOBAL_COLOR_PREVIEW_VALUE":return((e,t,r)=>e.setIn(["previewGlobalColors",t],{colorId:t,color:r}))(e,t.colorId,t.color);case"OPEN_PRESET_MODAL":return(e=>e.setIn(["presets","isActive"],!0))(e);case"CLOSE_PRESET_MODAL":return(e=>e.setIn(["presets","isActive"],!1))(e);case"EDIT_PRESET_ATTRIBUTE":return e.getIn(["presets","isSyncing"])?e:((e,{presetType:t,presetSubType:r,presetId:o,attrName:s,attrValue:n,updated:a,attrsGroup:i})=>{const l=["presets","items",t,r,"items",(0,d.getSelectedPresetOrDefault)(o,e.getIn(["presets","items",t,r,"default"]))];return Array.isArray(i)&&0<i.length&&(i.forEach((t=>{let r=l.concat(t);s&&(r=r.concat(s.split("."))),e=e.setIn(r,n)})),e=e.setIn(l.concat("updated"),a)),e})(e,{presetType:t.presetType,presetSubType:t.presetSubType,presetId:t.presetId,attrName:t.attrName,attrValue:t.attrValue,updated:t.updated,attrsGroup:t.attrsGroup});case"REMOVE_PRESET_ATTRIBUTE":return((e,{presetType:t,presetSubType:r,presetId:o,attrName:n,attrsGroup:a})=>{const i=["presets","items",t,r,"items",(0,d.getSelectedPresetOrDefault)(o,e.getIn(["presets","items",t,r,"default"]))],l=n.split("."),u=l[0];return a.forEach((t=>{const r=i.concat(t),o=r.concat(l),n=(0,s.slice)(o,0,o.length-1),a=e.getIn(n);if(!(0,s.isEmpty)(a)){const t=(0,s.last)(o),i=(e=e.setIn(n,a.without(t))).getIn(r),l=e.getIn(r.concat(u)),p=(0,d.removeEmptyObjectRecursive)(l?.asMutable({deep:!0}));(0,s.isEmpty)(p)?e=e.setIn(r,i.without(u)):(0,s.isEqual)(p,l?.asMutable({deep:!0}))||(e=e.setIn(r.concat(u),p))}})),e})(e,{presetType:t.presetType,presetSubType:t.presetSubType,presetId:t.presetId,attrName:t.attrName,attrsGroup:t.attrsGroup});case"ASSIGN_PRESET_TO_DEFAULT":return e.getIn(["presets","isSyncing"])?e:((e,t,r)=>{const o=["presets","items","module",r,"default"];return e.setIn(o,t)})(e,t.presetId,t.moduleName);case"ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r})=>{const o=G({presetId:t,groupName:r,state:e});if(o===e.getIn(["presets","items","group",r,"default"]))return e;const s=e.getIn(["presets","items","group",r,"items"])?.getIn([o]);return s?e.setIn(["presets","items","group",r,"default"],t):e})(e,{presetId:t.presetId,groupName:t.groupName,groupId:t.groupId});case"DELETE_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,t,r)=>{const o=e.getIn(["presets","items","module",r,"default"]),s=e.getIn(["presets","items","module",r,"items"]).without(t);let n=o;const a=Object.keys(s).length??0;if(o===t||1===a){const e=Object.values(s).sort(((e,t)=>e.created-t.created)).reduce(((e,t)=>({...e,[t.id]:t})),{});n=Object.keys(e)[0]??null}return e.setIn(["presets","items","module",r],{items:s,default:n})})(e,t.presetId,t.moduleName);case"DELETE_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r})=>{const o=G({presetId:t,groupName:r,state:e}),s=e.getIn(["presets","items","group",r,"items"]),n=s?.getIn([o]);if(!n)return e;const a=e.getIn(["presets","items","group",r,"default"]),i=s.without(t);let l=a;1===(Object.keys(i).length??0)?l=Object.keys(i)[0]??null:a===t&&(l=Object.values(i).sort(((e,t)=>(e.created??0)-(t.created??0)))[0]?.id??null);return e.setIn(["presets","items","group",r],{items:i,default:l})})(e,{presetId:t.presetId,groupName:t.groupName});case"CLONE_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,t,r,o)=>{const s=L({id:t,moduleName:r,state:e}),n=e.getIn(["presets","items","module",r,"items"])?.asMutable({deep:!0})??{},a=n[s],{id:i,name:l}=_(Object.values(n??{}).map((e=>e.name)),o),u={...a,id:i,name:l,created:Date.now(),updated:Date.now()};return e.setIn(["presets","items","module",r,"items",i],u)})(e,t.presetId,t.moduleName,t.moduleLabel);case"CLONE_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r,groupLabel:o})=>{const s=G({presetId:t,groupName:r,state:e}),n=e.getIn(["presets","items","group",r,"items"])?.getIn([s]);if(!n)return e;const a=e.getIn(["presets","items","group",r,"items"])?.asMutable({deep:!0}),i=Object.values(a??{}).map((e=>e.name)),{id:l,name:u}=_(i,o),p={...n,id:l,name:u,created:Date.now(),updated:Date.now()};return e.setIn(["presets","items","group",r,"items",l],p)})(e,{presetId:t.presetId,groupId:t.groupId,groupName:t.groupName,groupLabel:t.groupLabel,moduleId:t.moduleId});case"UPDATE_PRESET_WITH_CURRENT_STYLES":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,moduleName:r,attrs:o,styleAttrs:n,renderAttrs:a,updated:i})=>{const l=L({id:t,moduleName:r,state:e}),u=e.getIn(["presets","items","module",r,"items"])?.getIn([l]),p=u?.getIn(["attrs"])?.asMutable({deep:!0})??{},d=(0,s.merge)({},p,o);(0,s.isEmpty)(d)||(e=e.setIn(["presets","items","module",r,"items",l,"attrs"],d));const c=u.getIn(["styleAttrs"])?.asMutable({deep:!0})??{},g=(0,s.merge)({},c,n);(0,s.isEmpty)(g)||(e=e.setIn(["presets","items","module",r,"items",l,"styleAttrs"],g));const m=u.getIn(["renderAttrs"])?.asMutable({deep:!0})??{},f=(0,s.merge)({},m,a);return(0,s.isEmpty)(f)||(e=e.setIn(["presets","items","module",r,"items",l,"renderAttrs"],f)),e.setIn(["presets","items","module",r,"items",l,"updated"],i)})(e,{presetId:t.presetId,moduleName:t.moduleName,attrs:t.attrs,styleAttrs:t.styleAttrs,renderAttrs:t.renderAttrs,updated:t.updated,moduleId:t.moduleId});case"OPEN_CONFIRMATION_MODAL":return((e,{confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:s})=>e.setIn(["presets","confirmationModal"],{isVisible:!0,confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:s}))(e,{confirmationAction:t.confirmationAction,confirmationText:t.confirmationText,actionPayload:t.actionPayload,actionLabels:t.actionLabels});case"OPEN_OPTION_GROUP_CONFIRMATION_MODAL":return((e,{confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:s})=>e.setIn(["presets","optionGroupConfirmationModal"],{isVisible:!0,confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:s}))(e,{confirmationAction:t.confirmationAction,confirmationText:t.confirmationText,actionPayload:t.actionPayload,actionLabels:t.actionLabels});case"OPEN_OPTION_GROUP_PRESET_MODAL":return((e,{groupId:t,groupName:r,groupLabel:o,visible:s,offsetTop:n})=>e.setIn(["presets","optionGroupPresetModal"],{groupId:t,groupName:r,groupLabel:o,isOptionGroupModalOpen:s,offsetTop:n}))(e,{groupId:t.groupId,groupName:t.groupName,groupLabel:t.groupLabel,visible:t.visible,offsetTop:t.offsetTop});case"CLOSE_OPTION_GROUP_PRESET_MODAL":return(e=>e.setIn(["presets","optionGroupPresetModal","isOptionGroupModalOpen"],!1))(e);case"SET_OPTION_GROUP_PRESET_EDIT_MODE":return((e,{groupId:t,groupName:r,enabled:o})=>e.setIn(["presets","optionGroupPreset"],{groupId:t,groupName:r,isPresetActive:o}))(e,{groupId:t.groupId,groupName:t.groupName,enabled:t.enabled});case"CLOSE_CONFIRMATION_MODAL":return(e=>e.setIn(["presets","confirmationModal"],{isVisible:!1}))(e);case"CLOSE_OPTION_GROUP_CONFIRMATION_MODAL":return(e=>e.setIn(["presets","optionGroupConfirmationModal"],{isVisible:!1}))(e);case"UPDATE_PRESET_NAME":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,presetId:r,name:o,updated:s})=>{const n=L({id:r,moduleName:t,state:e});return e.setIn(["presets","items","module",t,"items",n,"updated"],s).setIn(["presets","items","module",t,"items",n,"name"],o)})(e,{moduleName:t.moduleName,presetId:t.presetId,name:t.name,updated:t.updated});case"ADD_NEW_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,moduleLabel:r,attrs:o,renderAttrs:n,styleAttrs:a,presetType:i,version:l,created:u,updated:p})=>{const d=e.getIn(["presets","items","module",t,"items"])?.asMutable({deep:!0}),c=Object.values(d??{}).map((e=>e.name)),g=y({presets:c,moduleLabel:r,moduleName:t,type:i,version:l,attrs:o,renderAttrs:n,styleAttrs:a,created:u,updated:p});return(0,s.isArray)(e?.asMutable({deep:!0})?.presets?.items?.module)&&(0,s.isEmpty)(e?.asMutable({deep:!0})?.presets?.items?.module)&&(e=e.setIn(["presets","items","module"],{})),e.setIn(["presets","items","module",t,"items",g.id],g)})(e,{moduleLabel:t.moduleLabel,moduleName:t.moduleName,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,presetType:t.presetType,version:t.version,created:t.created,updated:t.updated});case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,moduleLabel:r,attrs:o,renderAttrs:s,styleAttrs:n,presetType:a,version:i,created:l,updated:u})=>{const p=e.getIn(["presets","items","module",t,"items"])?.asMutable({deep:!0}),d=Object.values(p??{}).map((e=>e.name)),c=y({presets:d,moduleLabel:r,moduleName:t,type:a,version:i,attrs:o,renderAttrs:s,styleAttrs:n,created:l,updated:u});return e.setIn(["presets","items","module",t,"items",c.id],c)})(e,{moduleLabel:t.moduleLabel,moduleName:t.moduleName,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,presetType:t.presetType,version:t.version,created:t.created,updated:t.updated});case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":return((e,{groupName:t,groupLabel:r,attrs:o,renderAttrs:s,styleAttrs:n,version:a,created:i,updated:l,moduleName:u,groupId:p,primaryAttrName:d})=>{const c=e.getIn(["presets","items","group",t,"items"])?.asMutable({deep:!0}),g=Object.values(c??{}).map((e=>e.name)),m=O({presets:g,groupName:t,groupLabel:r,version:a,attrs:o,renderAttrs:s,styleAttrs:n,created:i,updated:l,moduleName:u,groupId:p,primaryAttrName:d});return e.setIn(["presets","items","group",t,"items",m.id],m)})(e,{moduleId:t.moduleId,groupId:t.groupId,groupName:t.groupName,groupLabel:t.groupLabel,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,version:t.version,created:t.created,updated:t.updated,moduleName:t.moduleName,primaryAttrName:t.primaryAttrName});case"ADD_DEFAULT_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,moduleLabel:r,presetType:o,version:s,created:n,updated:a})=>{const i=e.getIn(["presets","items","module",t,"items"]),l=Object.keys(i??{}).length,u=e.getIn(["presets","items","module",t,"default"]);if(l>0&&u)return e;const p=y({type:o,presets:[],moduleLabel:r,moduleName:t,version:s,created:n,updated:a});return l>0&&!u?e.setIn(["presets","items","module",t,"default"],p.id).setIn(["presets","items","module",t,"items"],{[p.id]:p,...i}):e.setIn(["presets","items","module",t,"items"],{[p.id]:p}).setIn(["presets","items","module",t,"default"],p.id)})(e,{moduleName:t.moduleName,moduleLabel:t.moduleLabel,created:t.created,updated:t.updated,version:t.version});case"ADD_DEFAULT_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{groupName:t,groupLabel:r,version:o,created:s,updated:n,moduleName:a,groupId:i,primaryAttrName:l})=>{const u=e.getIn(["presets","items","group",t,"items"]),p=Object.keys(u??{}).length,d=e.getIn(["presets","items","group",t,"default"]);if(p>0&&d)return e;const c=O({presets:[],groupLabel:r,groupName:t,version:o,created:s,updated:n,moduleName:a,groupId:i,primaryAttrName:l});return p>0&&!d?e.setIn(["presets","items","group",t,"default"],c.id).setIn(["presets","items","group",t,"items"],{[c.id]:c,...u}):e.setIn(["presets","items","group",t,"items"],{[c.id]:c}).setIn(["presets","items","group",t,"default"],c.id)})(e,{groupLabel:t.groupLabel,groupName:t.groupName,created:t.created,updated:t.updated,moduleName:t.moduleName,groupId:t.groupId,version:t.version,primaryAttrName:t.primaryAttrName});case"IMPORT_PRESETS":return((e,t)=>e.setIn(["presets","items"],e.getIn(["presets","items"]).merge(t,{deep:!0})))(e,t.presets);case"ADD_PRESET_ATTRS_MAP_JOB":return((e,{moduleName:t,id:r,callback:o})=>e.setIn(["presets","attrsMapping","jobs",t,r],o))(e,{moduleName:t.moduleName,id:t.id,callback:t.callback});case"SET_PRESET_ATTRS_MAP":return((e,{moduleName:t,map:r})=>e.setIn(["presets","attrsMapping","maps",t],r).setIn(["presets","attrsMapping","jobs"],e.getIn(["presets","attrsMapping","jobs"]).without(t)))(e,{moduleName:t.moduleName,map:t.map});case"SET_DEFAULT_PRESET_ON_SAVE":return e.getIn(["presets","isSyncing"])?e:((e,{presetType:t,presetSubType:r,presetId:o})=>{const s=(0,d.getSelectedPresetOrDefault)(o,e.getIn(["presets","items",t,r,"default"]));return e.setIn(["presets","defaultOnSave",t,r],s)})(e,{presetType:t.presetType,presetSubType:t.presetSubType,presetId:t.presetId});case"UNSET_DEFAULT_PRESET_ON_SAVE":return e.getIn(["presets","isSyncing"])?e:((e,{presetType:t,presetSubType:r})=>{if(t&&r){const o=e.getIn(["presets","defaultOnSave",t]);return o?e.setIn(["presets","defaultOnSave",t],o.without(r)):e}if(t){const r=e.getIn(["presets","defaultOnSave"]);return r?e.setIn(["presets","defaultOnSave"],r.without(t)):e}return e.setIn(["presets"],e.getIn(["presets"]).without("defaultOnSave"))})(e,{presetType:t.presetType,presetSubType:t.presetSubType});case"END_PRESET_EDIT_SESSION":return((e,t,r,o=null)=>{if(t){if("group"===r){const t=e.getIn(["presets","restorePoint","group"]),r=e.getIn(["presets","optionGroupPreset"])?.asMutable({deep:!0}),n=r?.isPresetActive?r?.groupId:null;if(t&&o&&n&&!(0,s.isEmpty)(t))return(e=e.setIn(["presets","items","group",o],t.getIn([o])?.asMutable({deep:!0}))).setIn(["presets","restorePoint","group"],null);(0,s.isEmpty)(t)||(e=e.setIn(["presets","items","group"],t?.asMutable({deep:!0})))}if("module"===r){const t=e.getIn(["presets","restorePoint","module"]);(0,s.isEmpty)(t)||(e=e.setIn(["presets","items","module"],t?.asMutable({deep:!0})))}if(!r){const t=e.getIn(["presets","restorePoint"]);t&&(e=e.setIn(["presets","items"],t?.asMutable({deep:!0})))}}switch(r){case"group":return e.setIn(["presets","restorePoint","group"],null);case"module":return e.setIn(["presets","restorePoint","module"],null);default:return e.setIn(["presets","restorePoint"],null)}})(e,t.isRollback,t.presetType,t.unsavedPresetGroupName);case"START_PRESET_EDIT_SESSION":return((e,{presetType:t,presetId:r,moduleName:o})=>{if("group"===t)return e.setIn(["presets","restorePoint","group"],e.getIn(["presets","items","group"])?.asMutable({deep:!0})??{});if("module"===t){if(r){const t=e.getIn(["presets","items","module",o,"items"]),s=e.getIn(["presets","items","module",o,"default"]),n=t.getIn([r])?.asMutable({deep:!0})??{};return e.setIn(["presets","restorePoint","module"],e.getIn(["presets","restorePoint","module"])?.asMutable({deep:!0})??{}).setIn(["presets","restorePoint","module",o,"items",r],n).setIn(["presets","restorePoint","module",o,"default"],s)}return e.setIn(["presets","restorePoint","module"],e.getIn(["presets","items","module"])?.asMutable({deep:!0})??{})}return e.setIn(["presets","restorePoint"],e.getIn(["presets","items"])?.asMutable({deep:!0})??{})})(e,{presetType:t.presetType,presetId:t.presetId,moduleName:t.moduleName});case"OVERRIDE_PRESET_DATA":return((e,t)=>e.setIn(["presets","items"],t))(e,t.data);case"END_SYNCING_PRESET":return((e,t)=>e.setIn(["presets","isSyncingError"],t).setIn(["presets","isSyncing"],!1))(e,t.isError);case"START_SYNCING_PRESET":return(e=>e.setIn(["presets","isSyncingError"],!1).setIn(["presets","isSyncing"],!0))(e);case"TOGGLE_PRESET_SAVE_CONFIRMATION_DIALOG":return((e,{flag:t})=>e.setIn(["presets","showPresetSaveConfirmationDialog"],t))(e,{flag:t.flag});case"TOGGLE_OPTION_GROUP_PRESET_SAVE_CONFIRMATION_DIALOG":return((e,{flag:t})=>e.setIn(["presets","optionGroupPreset","showSaveConfirmationDialog"],t))(e,{flag:t.flag});case"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r,attrs:o,renderAttrs:n,styleAttrs:a,updated:i})=>{const l=G({presetId:t,groupName:r,state:e}),u=e.getIn(["presets","items","group",r,"items"])?.getIn([l]);if(!u)return e;const p={attrs:o,styleAttrs:a,renderAttrs:n};return Object.keys(p).forEach((t=>{const o=p[t],n=u.getIn([t]),a=(0,s.merge)({},n,o);(0,s.isEmpty)(a)||(e=e.setIn(["presets","items","group",r,"items",l,t],a))})),e.setIn(["presets","items","group",r,"items",l,"updated"],i)})(e,{moduleId:t.moduleId,presetId:t.presetId,groupId:t.groupId,groupName:t.groupName,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,updated:t.updated});case"UPDATE_OPTION_GROUP_PRESET_NAME":return((e,{presetId:t,groupName:r,name:o,updated:s})=>{const n=G({presetId:t,groupName:r,state:e});return e.setIn(["presets","items","group",r,"items",n,"updated"],s).setIn(["presets","items","group",r,"items",n,"name"],o)})(e,{presetId:t.presetId,groupName:t.groupName,name:t.name,updated:t.updated});case"ADD_NEW_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{groupName:t,groupLabel:r,attrs:o,renderAttrs:n,styleAttrs:a,version:i,created:l,updated:u,moduleName:p,groupId:d,primaryAttrName:c})=>{const g=e.getIn(["presets","items","group"])?.asMutable({deep:!0});(0,s.isArray)(g)&&(0,s.isEmpty)(g)&&(e=e.setIn(["presets","items","group"],{}));const m=e.getIn(["presets","items","group",t,"items"])?.asMutable({deep:!0}),f=Object.values(m??{}).map((e=>e.name)),b=O({presets:f,groupName:t,groupLabel:r,version:i,attrs:o,renderAttrs:n,styleAttrs:a,created:l,updated:u,moduleName:p,groupId:d,primaryAttrName:c});return e.setIn(["presets","items","group",t,"items",b.id],b)})(e,{groupName:t.groupName,groupLabel:t.groupLabel,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,version:t.version,created:t.created,updated:t.updated,moduleName:t.moduleName,groupId:t.groupId,primaryAttrName:t.primaryAttrName});case"CLOSE_OPTION_GROUP_PRESET_EDIT_MODE":return((e,t)=>{const{groupId:r,groupName:o}=t||{};return r&&o?e.setIn(["presets","optionGroupPreset"],{groupId:r,groupName:o,isPresetActive:!1}):e.setIn(["presets"],e.getIn(["presets"]).without("optionGroupPreset"))})(e,{groupId:t.groupId,groupName:t.groupName});case"ADD_GLOBAL_VARIABLE":{const{id:r,label:o,value:n,groupKey:a,order:i,status:l,allowedActions:u,lastUpdated:p}=t;return((e,t,r,o,n,a=null,i="active",l={editLabel:!0,editValue:!0,remove:!0,reorder:!0},u=(new Date).toISOString())=>{const p=e.getIn(["globalVariables",n]).asMutable({deep:!0}),d=(0,s.pickBy)(p,(e=>"active"===e.status)),c={id:t,label:r,value:o,order:a=a??Number(Object.keys(d||{}).length)+1,status:i,allowedActions:l,lastUpdated:u,variableType:n};return e.setIn(["globalVariables",n,t],c)})(e,r,o,n,a,i,l,u,p)}case"ADD_GLOBAL_VARIABLES":return((e,{...t})=>e.setIn(["globalVariables"],t))(e,{numbers:t.numbers,strings:t.strings,images:t.images,links:t.links,colors:t.colors,fonts:t.fonts});case"DELETE_GLOBAL_VARIABLE":return((e,t,r)=>{const o=e.getIn(["globalVariables",r,t]);if(!o)return e;if(!o.label||!o.value)return e.setIn(["globalVariables",r],e.getIn(["globalVariables",r]).without(t));const n=e.setIn(["globalVariables",r,t],{...o,status:"archived",order:null}),a=n.getIn(["globalVariables",r]).without((e=>"archived"===e.status));let i=a;return Object.values(a).forEach(((e,t)=>{i=i.setIn([e.id,"order"],t+1)})),e.setIn(["globalVariables",r],(0,s.merge)({...n.getIn(["globalVariables",r]),...i}))})(e,t.id,t.groupKey);case"UPDATE_GLOBAL_VARIABLE":{const{id:r,label:o,value:s,groupKey:n,status:a}=t;return((e,t,r,o,s,n="active")=>{const a=e.getIn(["globalVariables",s,t]);return a?e.setIn(["globalVariables",s,t],{...a,lastUpdated:(new Date).toISOString(),label:r,value:o,status:n}):e})(e,r,o,s,n,a)}case"UPDATE_GLOBAL_VARIABLES":return((e,t)=>((0,s.forEach)(t,(t=>{e=e.setIn(["globalVariables",t.groupKey,t.id],{...t,lastUpdated:t?.lastUpdated??(new Date).toISOString(),label:t.label,value:t.value,status:t?.status??"active"})})),e))(e,t.variables);case"UPDATE_GLOBAL_VARIABLE_ORDER":return((e,t,r,o)=>{const s=e.getIn(["globalVariables",o]);if(!s||!(t in s))return e;const n=Object.values(s).filter((e=>"archived"!==e.status)).sort(((e,t)=>e.order-t.order)),a=n.findIndex((e=>e.id===t)),[i]=n.splice(a,1);n.splice(r-1,0,i);let l=s;return n.forEach(((e,t)=>{l=l.setIn([e.id,"order"],t+1)})),e.setIn(["globalVariables",o],l)})(e,t.id,t.order,t.groupKey);case"UPDATE_GLOBAL_VARIABLES_BACKUP":return(e=>e.setIn(["globalVariablesBackup"],e.getIn(["globalVariables"])))(e);case"RESET_GLOBAL_VARIABLES":return(e=>e.setIn(["globalVariables"],e.getIn(["globalVariablesBackup"])))(e);case"RESTORE_GLOBAL_VARIABLE":return((e,t,r)=>{const o=e.getIn(["globalVariables",r]),n=e.getIn(["globalVariables",r,t]);if(!n)return e;const a=(0,s.pickBy)(o,(e=>"active"===e.status)),i=Number(Object.keys(a).length)+1;return e.setIn(["globalVariables",r,t],{...n,status:"active",order:i})})(e,t.id,t.groupKey);default:return e}},lr=()=>{if((0,l.select)("divi/settings")||(0,c.registerSettingsStore)(),(0,l.select)("divi/fonts")||(0,u.registerFontsStore)(),(0,l.select)("divi/colors")||(0,i.registerColorsStore)(),(0,l.select)("divi/global-data"))return;const r=(e=>{if(!e)return e;if(!e?.group)return e;const t=(0,n.asMutable)(e?.group,{deep:!0});return Object.keys(t).forEach((e=>{const{items:r}=t[e];Object.keys(r).forEach((o=>{(e=>!!e.groupId&&!!e.moduleName)(r[o])||delete t[e].items[o]}))})),e.setIn(["group"],t)})((0,l.select)("divi/settings").getSetting(["globalPresets","data"])),o=(0,l.select)("divi/settings").getSetting(["settings","page","values"],a()({})),g=o?.getIn(["post_content","et_pb_gc_palette"]),f=o?.getIn(["post_content","et_pb_global_variables"]),b={globalColors:(0,s.isEmpty)(g)?{}:g.asMutable({deep:!0}),previewGlobalColors:{},isGlobalColorEditing:!1,globalVariables:f,globalVariablesBackup:f,fetchLog:{},fetchError:{},presets:{items:(0,d.removeEmptyObjectRecursive)((0,n.asMutable)(r,{deep:!0}),!0),confirmationModal:{isVisible:!1,confirmationAction:null,confirmationText:null,actionPayload:{},actionLabels:{}},optionGroupPresetModal:{groupId:"",isOptionGroupModalOpen:!1,offsetTop:"",groupName:"",groupLabel:""},optionGroupConfirmationModal:{isVisible:!1,confirmationAction:null,confirmationText:null,actionPayload:{},actionLabels:{}},optionGroupPreset:{groupId:"",groupName:"",isPresetActive:!1,showSaveConfirmationDialog:!0},restorePoint:null,defaultOnSave:null,isSyncing:!1,isSyncingError:!1,isActive:!1,showPresetSaveConfirmationDialog:!0,attrsMapping:{jobs:{},maps:{}}}},E=a()(b),I=(0,l.registerStore)("divi/global-data",{actions:e,reducer:ir,selectors:t,initialState:E});(0,p.applyMiddlewares)(I,ar),(0,p.applyEffects)(I,nr),m(["fonts","colors"]),(0,l.dispatch)("divi/global-data").updateGlobalVariablesBackup()},ur=e=>{const{globalColors:t,previewGlobalColors:r,globalVariables:o}=e,n={...o?.numbers,...o?.fonts,...o?.images};let a="",i="",l="";return(0,s.forEach)(t,((e,t)=>e?.color?a+=`--${t}: ${e.color};`:"")),(0,s.forEach)(r,(e=>(0,s.isEmpty)(e)?"":i+=`--${e.colorId}: ${e.color};`)),(0,s.forEach)(n,((e,t)=>{if(e?.value){const r=o?.images?.[t]?`url(${e.value})`:e.value;l+=T(t,r)}})),(0,s.isEmpty)(a)?null:Xt().createElement(Xt().Fragment,null,Xt().createElement("style",{className:"et-vb-global-data et-vb-global-colors"},`:root{${a}}`),Xt().createElement("style",{className:"et-vb-global-data et-vb-global-variables et-vb-global-variables-numbers"},`:root{${l}}`),(0,s.isEmpty)(i)?"":Xt().createElement("style",{className:"et-vb-global-data et-vb-preview-global-colors"},`:root{${i}}`))},pr=()=>{const{globalColors:e,previewGlobalColors:t}=(0,l.useSelect)((e=>({globalColors:e("divi/global-data").getGlobalColors(),previewGlobalColors:e("divi/global-data").getPreviewGlobalColors()})));let r={images:{},links:{},numbers:{},strings:{},colors:{},fonts:{}};(0,Qt.useEffect)((()=>{r?.fonts&&(0,s.forEach)(r.fonts,((e,t)=>{e?.value&&t.startsWith("gvid-")&&(0,l.dispatch)("divi/fonts").loadFont(e?.value)}))}),[r.fonts]);const{globalVariables:o}=(0,l.useSelect)((e=>({globalVariables:e("divi/global-data").getGlobalVariables()})));return r=o,(0,Qt.createElement)(ur,{globalColors:e,previewGlobalColors:t,globalVariables:r})}}(),(window.divi=window.divi||{}).globalData=o}();